<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="css/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="css/menuComponent.css">
    <title>菜单组件</title>
</head>
<body>
    <div class="ui container">

        <!-- 菜单 -->
        <div class="menu-content">
            <div class="ui three item menu">
                <a class="item active">社论</a>
                <a class="item">Reviews</a>
                <a class="item">即将举办的活动</a>
            </div>
        </div>

        <!-- tab切换 -->
        <div class="ui three item tab-content">
            <div class="ui top attached tabular menu">
                <a class="item">个人简历 </a>
                <a class="active item">Photos </a>
            </div>
            <div class="ui bottom attached segment active">
                <p>个人简历的内容</p>
            </div>
            <div class="ui bottom attached segment">
                <p>photo的内容</p>
            </div>
        </div>
    </div>
    
    <script>

        class Menu{
            // 1. 我感觉这个菜单容器传class名，不是很好
            //   我觉得直接选selector或者DOM元素会比较好。
            //   我建议你两者都支持。
            //   可以根据 typeof element === 'string' 来判断是选择器还是DOM元素
            // 2. 现在菜单里面能点的项的选择器，是写死.item的，建议加一个options的Object参数，
            //   里面有一个比如itemSelector的来配置，默认为'.item'
            constructor ( opt ) {

                this.itemSelector='.item';

                Object.assign(this,opt);

                this.menuList=( typeof this.nav==='string' ? document.querySelectorAll( this.nav+ ' '+this.itemSelector ) : this.nav.querySelectorAll( this.itemSelector ) ) ;

                this.onMenuItemSwitch();

            }
            // 我觉得init其实就是初始化的意思，初始化其实就是constructor的意思
            // 所以可以直接把init里面的内容放到constractor里面来，因为现在这里只有两句话
            onMenuItemSwitch () {

                this.menuList.forEach( (list, index) =>{

                    list.addEventListener('click', () =>{

                        this.menuList.forEach( (list) =>{

                            list.classList.remove( 'active' );

                        })

                        list.classList.add( 'active' );

                        // 这里可以简写哦，this.funCall && this.funCall(index);
                        // 这个调用子类设计还不错，不过名字可以改得更合适一些
                        // 比如 onMenuItemSwitch等，我随便取的，你会发现，当花点时间想名字的时候，会对这个组件理解得更深刻。
                        return this.onTabPanelAwitch && this.onTabPanelAwitch( index );

                    })
                })
            }
        }

        //Tab重用Menu
        class Tab extends Menu{
            // 构造函数的参数问题和Menu一样，需要优化
            constructor( opt ){

                super( opt );

                Object.assign(this,opt);

                this.init();
            }

            init(){
                console.log(this);

                this.root=document.querySelector( this.nav || '.tab-content' );
                
                this.segments=this.root.querySelectorAll( this.panel );

                this.selected=this.selected || this.root.querySelector( " "+this.itemSelector+".active" );

                let event=new Event('click');

                this.selected.dispatchEvent(event);

            }

            onTabPanelAwitch(index){
                this.segments.forEach( (item) =>{

                    item.classList.remove( 'active' );

                    item.style.display='none';
                })

                this.segments[index].classList.add( 'active' );

                this.segments[index].style.display='block';
            }

        }

        // const menuList=document.querySelector('.menu-content .menu');

        // const TabList=document.querySelector('.tab-content');

        const menu=new Menu({
            nav:'.menu-content .menu',
        });

        const tab=new Tab(
            {
                nav:'.tab-content',
                panel:'.segment'
            });

        // const menu=new Menu(menuList);

        // const tab=new Tab(TabList);

    </script>
</body>
</html>